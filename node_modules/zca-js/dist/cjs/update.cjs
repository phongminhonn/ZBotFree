'use strict';

var semver = require('semver');
var utils = require('./utils.cjs');
var context = require('./context.cjs');

const VERSION = "1.5.1";
const NPM_REGISTRY = "https://registry.npmjs.org/zca-js";
async function checkUpdate() {
    if (!context.appContext.options.checkUpdate)
        return;
    const response = await fetch(NPM_REGISTRY).catch(() => null);
    if (!response || !response.ok)
        return;
    const data = await response.json().catch(() => null);
    if (!data)
        return;
    const latestVersion = data["dist-tags"].latest;
    if (semver.compare(VERSION, latestVersion) === -1) {
        utils.logger.info(`A new version of zca-js is available: ${latestVersion}`);
    }
    else {
        utils.logger.info("zca-js is up to date");
    }
}

exports.checkUpdate = checkUpdate;
